CKEDITOR.dialog.add('esp_anchor',function(g){var h=function(a){this._.selectedElement=a;var b=a.data('cke-saved-name');this.setValueOf('info','txtName',b||'')};function createFakeAnchor(a,b){return a.createFakeElement(b,'cke_anchor','anchor')}return{title:g.lang.anchor.title,minWidth:300,minHeight:60,onOk:function(){var a=this.getValueOf('info','txtName');var b={name:a,'data-cke-saved-name':a};if(this._.selectedElement){if(this._.selectedElement.data('cke-realelement')){var c=createFakeAnchor(g,g.document.createElement('a',{attributes:b}));c.replace(this._.selectedElement)}else this._.selectedElement.setAttributes(b)}else{var d=g.getSelection(),range=d&&d.getRanges()[0];if(range.collapsed){if(CKEDITOR.plugins.link.synAnchorSelector)b['class']='cke_anchor_empty';if(CKEDITOR.plugins.link.emptyAnchorFix){b['contenteditable']='false';b['data-cke-editable']=1}var e=g.document.createElement('a',{attributes:b});if(CKEDITOR.plugins.link.fakeAnchor)e=createFakeAnchor(g,e);range.insertNode(e)}else{if(CKEDITOR.env.ie&&CKEDITOR.env.version<9)b['class']='cke_anchor';var f=new CKEDITOR.style({element:'a',attributes:b});f.type=CKEDITOR.STYLE_INLINE;f.apply(g.document)}}},onHide:function(){delete this._.selectedElement},onShow:function(){var a=g.getSelection(),fullySelected=a.getSelectedElement(),partialSelected;if(fullySelected){if(CKEDITOR.plugins.link.fakeAnchor){var b=CKEDITOR.plugins.link.tryRestoreFakeAnchor(g,fullySelected);b&&h.call(this,b);this._.selectedElement=fullySelected}else if(fullySelected.is('a')&&fullySelected.hasAttribute('name'))h.call(this,fullySelected)}else{partialSelected=CKEDITOR.plugins.link.getSelectedLink(g);if(partialSelected){h.call(this,partialSelected);a.selectElement(partialSelected)}}this.getContentElement('info','txtName').focus()},contents:[{id:'info',label:g.lang.anchor.title,accessKey:'I',elements:[{type:'text',id:'txtName',label:g.lang.anchor.name,required:true,validate:function(){if(!this.getValue()){alert(g.lang.anchor.errorName);return false}return true}}]}]}});

